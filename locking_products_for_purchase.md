Prevent users from buying products if stock is not available

Before a user tries to make a payment, make an api call to lock specific stock. But also, check if there is enough of stock available.